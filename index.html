<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-g" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SatNav: Live Crowd Map</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <!-- Add jsQR library -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <!-- Add Socket.IO client library -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
<style>
  /* Leaflet popup customization - Not used anymore but kept for potential future use */
  .leaflet-popup-content-wrapper {
    background-color: rgba(31, 41, 55, 0.8) !important; /* bg-gray-800 with opacity */
    color: #e5e7eb !important; /* text-gray-200 */
    border-radius: 0.75rem !important; /* rounded-xl */
    border: 1px solid #fb923c !important; /* border-orange-400 */
    backdrop-filter: blur(4px);
  }
  .leaflet-popup-content {
    margin: 1rem !important; /* p-4 */
    font-family: 'Poppins', sans-serif;
  }
  .leaflet-popup-tip-container {
    display: none;
  }
  .leaflet-popup-close-button {
    color: #9ca3af !important; /* text-gray-400 */
    font-size: 1.5rem !important;
    padding: 0.5rem 0.5rem 0 0 !important;
  }
  .leaflet-popup-close-button:hover {
    color: #ffffff !important;
  }

  /* Smoother pulsing animation for heatmap circles */
  @keyframes pulse {
    0%, 100% {
      transform: scale(0.95);
      opacity: 0.3;
    }
    50% {
      transform: scale(1.1);
      opacity: 0.6;
    }
  }

  .heatmap-pulse {
    animation-name: pulse;
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out; /* Makes the pulse more natural */
    /* Fix: Ensure SVG scales from its center */
    transform-origin: center;
    transform-box: fill-box;
  }
  .pulse-slow { animation-duration: 4s; }
  .pulse-medium { animation-duration: 3s; }
  .pulse-fast { animation-duration: 2s; }
  .pulse-very-fast { animation-duration: 1s; }
  
  /* Refined selected marker animation - now a smooth, continuous loop */
  @keyframes pulse-ring {
    0%, 100% {
      transform: scale(1);
      opacity: 0.6;
    }
    50% {
      transform: scale(1.4);
      opacity: 0.1;
    }
  }

  @keyframes pulse-dot {
    0%, 100% {
      transform: scale(.9);
    }
    50% {
      transform: scale(1);
    }
  }

  /* Card Animation - Generic for all screen sizes */
  @keyframes card-enter {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }
  .animate-card-enter {
    animation: card-enter 0.3s ease-out forwards;
  }

  /* QR Scanner Modal Styles */
  .qr-scanner-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000; /* High z-index to be on top */
    backdrop-filter: blur(5px);
  }

  .qr-scanner-container {
    position: relative;
    width: 90vw;
    max-width: 500px;
    background-color: #1f2937; /* bg-gray-800 */
    border-radius: 1rem; /* rounded-2xl */
    overflow: hidden;
    border: 1px solid #4b5563; /* border-gray-600 */
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  }

  .qr-scanner-video {
    width: 100%;
    height: auto;
    display: block;
  }
  
  .qr-scanner-box {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 70%;
    height: 50%;
    transform: translate(-50%, -50%);
    border: 3px solid rgba(251, 146, 60, 0.8); /* border-orange-400 */
    box-shadow: 0 0 0 2000px rgba(0, 0, 0, 0.5);
    border-radius: 0.5rem; /* rounded-lg */
  }

  /* Notification Animation */
  @keyframes slide-down-fade-in {
    from {
      opacity: 0;
      transform: translateY(-100%);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-notification-enter {
    animation: slide-down-fade-in 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  }
</style>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-gray-900">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>